
![Logo](storage/public/readme_logo.png)


# Динамограф AI

Данный репозиторий содержит исходный код "Динамографа" - Python приложения, 
основанного на FastAPI, интегрированного с машинным обучением для анализа динамограмм. Используется приложением
для мониторинга и управления скважинами - [**Светофор**](https://github.com/YaraZan/trafficlight), 
а также клиентским приложением [**Динамограф**](https://github.com/YaraZan/dinamograph-client).

[![MIT License](https://img.shields.io/badge/License-MIT-green.svg)](https://choosealicense.com/licenses/mit/)
![TensorFlow](https://img.shields.io/badge/TensorFlow-%23FF6F00.svg?plastic&logo=TensorFlow&logoColor=white)
![Keras](https://img.shields.io/badge/Keras-%23D00000.svg?plastic&logo=Keras&logoColor=white)
![FastAPI](https://img.shields.io/badge/FastAPI-005571?plastic&logo=fastapi)
![Python](https://img.shields.io/badge/python-3670A0?plastic&logo=python&logoColor=ffdd54)


## v1

- [x] **Анализ Динамограмм:**

  Приложение позволяет проводить анализ динамограмм в двух форматах:
    `Сырые данные` и `Изображение`.

- [x] **Создание новых маркеров**

    В настоящее время поддерживается список маркеров, состоящий из 20 элементов

- [x] **Пополнение датасетов и обучение**

    Возможность постоянного пополнения датасетов новыми данными и дообучение модели

- [ ] **Дополнительные параметры**

    Включение параметров скважины для наиболее тонкого анализа


## Примеры API эндпоинтов (v1)

Все запросы должны начинаться с префикса `/v1`. Эндпоинты `/dnm`, `/marker`, `/ai` поддерживают все
операции CRUD. Приведённые ниже запросы являются публичными и требуют для валидации **API ключи**, которые
устанавливаются в заголовок `Authorization: Basic <YOUR_API_KEY>`. Ключи можно получить в приложении [**Динамограф**](https://github.com/YaraZan/dinamograph-client).

<br>

#### Получить случайную немаркированную динамограмму

Используется для получения пользователями [**Светофора**](https://github.com/YaraZan/trafficlight) случайной непромаркированной 
динамограммы. В результате пользователь получит объект с последней присвоенной ему динамограммой или же будет сгенерированна и отправлена новая.

```
  GET /dnm/random/${public_id}
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `public_id` | `string` | **Required**. Публичный id пользователя "Светофор" |

<br>

#### Получить все маркеры

```
  GET /dnm/marker/all
```

Используется для получения пользователями [**Светофора**](https://github.com/YaraZan/trafficlight) всех доступных
(1) *маркеров*. В результате пользователь получит список с объектами маркеров, которыми далее можно будет промаркировать
полученную динамограмму

*(1) Маркер - условное обозначение "Эталонной динамограммы", т.е изображения, которое отображает конкретую неисправность в
ШГН.*


<br>

#### Промаркировать динамограмму

Используется для получения пользователями [**Светофора**](https://github.com/YaraZan/trafficlight) случайной непромаркированной 
динамограммы. В результате пользователь получит объект с последней присвоенной ему динамограммой или же будет сгенерированна и отправлена новая.

```
  POST /dnm/mark
```

| Parameter       | Type   | Description                                |
|:----------------|:-------|:-------------------------------------------|
| `dnm_id` | `list` | **Required**. Id динамограммы              |
| `marking_data`  | `list` | **Required**. Список маркеров динамограммы |

<br>

#### Анализ изображения

Используется для создания отчётов по скважине. В результате пользователь получит строку - результат анализа.

```
  POST /ai/predict/image
```

| Parameter | Type   | Description              |
|:----------|:-------|:-------------------------|
| `image`   | `file` | Изображение динамограммы |

<br>

#### Анализ сырых данных

Принцип действия схожий с анализом по изображению, только предварительно данные конвертируются в матричный вид для удобства распознавания моделью машинного обучения.

```
  POST /ai/predict/raw
```

| Parameter     | Type   | Description                   |
| :------------ |:-------| :---------------------------- |
| `raw_data`   | `list` | Объект с точками динамограммы      |


## Стек технологий
**Client:** Vue, Vite, TailwindCSS

**Server:** FastAPI, Uvicorn

**DL:** TensorFlow, Keras 

## Производство

Проект нашёл своё применение в компании [ПАО "Татнефть"](https://www.tatneft.ru/)



